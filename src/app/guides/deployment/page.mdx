# Deploying Nextra to Webflow Cloud

This guide will walk you through deploying a Nextra 4.0 documentation site to Webflow Cloud, running on Cloudflare Workers edge runtime.

## What You'll Learn

- How to set up a Nextra project for Webflow Cloud
- Understanding edge runtime compatibility
- Configuring critical files for deployment
- Deploying via GitHub or CLI

## Prerequisites

Before you begin, make sure you have:

- **Node.js 20.0.0 or higher** installed
- **npm package manager**
- A **Webflow account** ([Sign up](https://webflow.com/))
- **Webflow CLI**: Install with `npm install -g @webflow/cli`
- **Git** for version control
- Basic knowledge of React/Next.js

## Quick Start

### 1. Clone the Repository

```bash
# Clone this template
git clone <your-repository-url>
cd <your-repository-name>

# Install dependencies
npm install

# Run development server
npm run dev
```

Visit http://localhost:3000 to see your documentation site.

### 2. Project Structure

Understanding the key files:

```
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx           # Root layout with Nextra components
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ _meta.tsx            # Sidebar navigation structure
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.mdx             # Home page
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ [your-docs]/         # Your documentation pages
‚îÇ   ‚îú‚îÄ‚îÄ components/              # React components
‚îÇ   ‚îî‚îÄ‚îÄ devlink/                 # Webflow Devlink components
‚îú‚îÄ‚îÄ mdx-components.tsx           # Theme component imports (CRITICAL)
‚îú‚îÄ‚îÄ next.config.ts               # Next.js + Nextra + Edge runtime config
‚îú‚îÄ‚îÄ theme.config.tsx             # Nextra theme settings
‚îú‚îÄ‚îÄ wrangler.json                # Cloudflare Workers config
‚îú‚îÄ‚îÄ webflow.json                 # Webflow Cloud config
‚îî‚îÄ‚îÄ open-next.config.ts          # OpenNext adapter config
```

## Critical Configuration Files

### mdx-components.tsx

**Most Important File** - Without this, your sidebar won't render:

```typescript
import type { MDXComponents } from "mdx/types";
import { useMDXComponents as getThemeComponents } from 'nextra-theme-docs';

export function useMDXComponents(components: MDXComponents): MDXComponents {
  const themeComponents = getThemeComponents();

  return {
    ...themeComponents,
    ...components,
  };
}
```

### next.config.ts

Handles edge runtime compatibility:

```typescript
const nextConfig: NextConfig = {
  // Mark file system libraries as external
  serverExternalPackages: ['@nodelib/fs.scandir', '@nodelib/fs.stat', 'fast-glob'],

  // Webflow injects code that causes TS errors
  typescript: {
    ignoreBuildErrors: true,
  },

  // Prevent fs module from bundling on client
  webpack: (config, { isServer }) => {
    if (!isServer) {
      config.resolve.fallback = {
        fs: false,
        module: false,
        path: false,
        os: false,
      };
    }
    return config;
  },
};
```

### wrangler.json

Enables Node.js compatibility in Cloudflare Workers:

```json
{
  "compatibility_flags": ["nodejs_compat"]
}
```

This flag is **critical** - it enables partial Node.js API support at runtime.

## Deployment Methods

### Method 1: GitHub Integration (Recommended) ‚≠ê

This method provides automatic deployments whenever you push to GitHub.

#### Steps:

1. **Push to GitHub**

   Push your project to a GitHub repository (public or private).

2. **Connect to Webflow Cloud**

   - Go to [Webflow Dashboard](https://webflow.com/dashboard) ‚Üí **Webflow Cloud**
   - Click **Sign in with GitHub** to authorize

3. **Create New Project**

   - Click **Create a new project**
   - Select your GitHub repository
   - Choose the branch to deploy (e.g., `main` or `master`)

4. **Configure and Deploy**

   - Set your custom domain path (e.g., `/docs`)
   - Click **Deploy**

**Benefits:**
- ‚úÖ Simple visual interface
- ‚úÖ Automatic deployments on git push
- ‚úÖ Easy to maintain
- ‚úÖ Built-in CI/CD

### Method 2: CLI Deployment

For developers who prefer command-line:

```bash
# Initialize Webflow Cloud (first time only)
webflow cloud init

# Deploy
webflow cloud deploy
```

## How It Works

### Build Time vs Runtime

The key to making Nextra work on Webflow Cloud:

**Build Time (‚úÖ Allowed)**
- Nextra scans MDX files using fast-glob
- Generates a page map for navigation

**Runtime (‚úÖ No File System Needed)**
- Only the generated page map is used
- No `fs` module access required

### Architecture

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  MDX Files  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ Build Time
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Nextra Scan    ‚îÇ ‚Üê Uses fs, fast-glob
‚îÇ  (Build Only)   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Page Map      ‚îÇ ‚Üê Generated artifact
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ Runtime
       ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Cloudflare      ‚îÇ ‚Üê No fs module needed
‚îÇ Workers         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## Common Issues & Solutions

### Issue: Sidebar Not Showing

**Cause**: Missing theme component imports

**Solution**: Ensure `mdx-components.tsx` imports theme components:

```typescript
import { useMDXComponents as getThemeComponents } from 'nextra-theme-docs';
```

### Issue: "Module not found: fs"

**Cause**: File system libraries bundled for client/edge

**Solution**: Add to `next.config.ts`:

```typescript
serverExternalPackages: ['@nodelib/fs.scandir', '@nodelib/fs.stat', 'fast-glob']

webpack: (config, { isServer }) => {
  if (!isServer) {
    config.resolve.fallback = { fs: false, module: false, path: false, os: false };
  }
  return config;
}
```

### Issue: TypeScript Build Errors

**Cause**: Webflow injects code that triggers type errors

**Solution**: Disable TypeScript checks during build:

```typescript
typescript: {
  ignoreBuildErrors: true,
}
```

## Customizing Your Site

### Update Theme Configuration

Edit `theme.config.tsx`:

```tsx
const config: DocsThemeConfig = {
  logo: <span style={{ fontWeight: "bold" }}>üìö Your Docs</span>,
  project: {
    link: "https://github.com/yourusername/your-repo",
  },
  docsRepositoryBase: "https://github.com/yourusername/your-repo/tree/main",
  footer: {
    content: (
      <span>
        {new Date().getFullYear()} ¬© Your Company
      </span>
    ),
  },
};
```

### Add Documentation Pages

Create MDX files in `src/app/`:

```bash
src/app/
‚îú‚îÄ‚îÄ getting-started/
‚îÇ   ‚îî‚îÄ‚îÄ page.mdx
‚îú‚îÄ‚îÄ guides/
‚îÇ   ‚îî‚îÄ‚îÄ page.mdx
‚îî‚îÄ‚îÄ api-reference/
    ‚îî‚îÄ‚îÄ page.mdx
```

Update `src/app/_meta.tsx` for navigation:

```tsx
export default {
  index: "Home",
  "getting-started": "Getting Started",
  guides: "Guides",
  "api-reference": "API Reference",
};
```

## Search Functionality

‚ö†Ô∏è **Search is not supported** in this version.

Nextra's default search (Pagefind) is incompatible with Webflow Cloud's edge runtime due to CORS restrictions and Cloudflare Workers limitations.

While third-party solutions like Algolia could be integrated, this template focuses on providing a minimal, working deployment.

## Next Steps

- ‚úÖ Customize your theme colors and branding
- ‚úÖ Add your documentation content
- ‚úÖ Set up custom domain (optional)
- ‚úÖ Configure environment variables if needed
- ‚úÖ Monitor deployment status in Webflow Dashboard

## Resources

- [Nextra Documentation](https://nextra.site/docs)
- [Webflow Cloud Documentation](https://developers.webflow.com/webflow-cloud)
- [Node.js Compatibility on Webflow Cloud](https://developers.webflow.com/webflow-cloud/environment/nodejs-compatibility)
- [OpenNext Cloudflare Adapter](https://opennext.js.org/cloudflare)
- [GitHub Repository](https://github.com/lvsao/webflow-nextra)

## Need Help?

- Visit [Webflow's Developer Forum](https://discourse.webflow.com/c/app-developers/90)
- Check the [GitHub Issues](https://github.com/lvsao/webflow-nextra/issues)
- Review the official documentation linked above
